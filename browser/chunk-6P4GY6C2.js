import{b as C,c as k}from"./chunk-7A7RQRVN.js";import{a as v,d as b}from"./chunk-6LMVZKMZ.js";import{a as E,b as M}from"./chunk-EU62SVTO.js";import{g as D,h as T,j as p,k as m,l as y}from"./chunk-VE22RIJ6.js";import{a as x}from"./chunk-5SDLENZK.js";import{a as w}from"./chunk-3WG2WLZ4.js";import{d as U,e as B}from"./chunk-HFWKE5SR.js";import{a as K}from"./chunk-A3WFPZFR.js";import{b as z}from"./chunk-65CEQG3Z.js";import{b as S}from"./chunk-4UCLQGBG.js";import{g as V}from"./chunk-GON3DZPO.js";var L=class s{constructor(e,t,n){this.name=e,this.from=t,this.to=n}clone(){return new s(this.name,this.from,this.to)}};var Y=class{constructor(){this._doNotSerialize=!1,this._isDisposed=!1,this._sceneRootNodesIndex=-1,this._isEnabled=!0,this._isParentEnabled=!0,this._isReady=!0,this._onEnabledStateChangedObservable=new S,this._onClonedObservable=new S}},N=class s{static AddNodeConstructor(e,t){this._NodeConstructors[e]=t}static Construct(e,t,n,a){let i=this._NodeConstructors[e];return i?i(t,n,a):null}set accessibilityTag(e){this._accessibilityTag=e,this.onAccessibilityTagChangedObservable.notifyObservers(e)}get accessibilityTag(){return this._accessibilityTag}get doNotSerialize(){return this._nodeDataStorage._doNotSerialize?!0:this._parentNode?this._parentNode.doNotSerialize:!1}set doNotSerialize(e){this._nodeDataStorage._doNotSerialize=e}isDisposed(){return this._nodeDataStorage._isDisposed}set parent(e){if(this._parentNode===e)return;let t=this._parentNode;if(this._parentNode&&this._parentNode._children!==void 0&&this._parentNode._children!==null){let n=this._parentNode._children.indexOf(this);n!==-1&&this._parentNode._children.splice(n,1),!e&&!this._nodeDataStorage._isDisposed&&this._addToSceneRootNodes()}this._parentNode=e,this._isDirty=!0,this._parentNode&&((this._parentNode._children===void 0||this._parentNode._children===null)&&(this._parentNode._children=new Array),this._parentNode._children.push(this),t||this._removeFromSceneRootNodes()),this._syncParentEnabledState()}get parent(){return this._parentNode}_serializeAsParent(e){e.parentId=this.uniqueId}_addToSceneRootNodes(){this._nodeDataStorage._sceneRootNodesIndex===-1&&(this._nodeDataStorage._sceneRootNodesIndex=this._scene.rootNodes.length,this._scene.rootNodes.push(this))}_removeFromSceneRootNodes(){if(this._nodeDataStorage._sceneRootNodesIndex!==-1){let e=this._scene.rootNodes,t=e.length-1;e[this._nodeDataStorage._sceneRootNodesIndex]=e[t],e[this._nodeDataStorage._sceneRootNodesIndex]._nodeDataStorage._sceneRootNodesIndex=this._nodeDataStorage._sceneRootNodesIndex,this._scene.rootNodes.pop(),this._nodeDataStorage._sceneRootNodesIndex=-1}}get animationPropertiesOverride(){return this._animationPropertiesOverride?this._animationPropertiesOverride:this._scene.animationPropertiesOverride}set animationPropertiesOverride(e){this._animationPropertiesOverride=e}getClassName(){return"Node"}set onDispose(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)}get onEnabledStateChangedObservable(){return this._nodeDataStorage._onEnabledStateChangedObservable}get onClonedObservable(){return this._nodeDataStorage._onClonedObservable}constructor(e,t=null,n=!0){this._isDirty=!1,this._nodeDataStorage=new Y,this.state="",this.metadata=null,this.reservedDataStore=null,this._accessibilityTag=null,this.onAccessibilityTagChangedObservable=new S,this._parentContainer=null,this.animations=[],this._ranges={},this.onReady=null,this._currentRenderId=-1,this._parentUpdateId=-1,this._childUpdateId=-1,this._waitingParentId=null,this._waitingParentInstanceIndex=null,this._waitingParsedUniqueId=null,this._cache={},this._parentNode=null,this._children=null,this._worldMatrix=m.Identity(),this._worldMatrixDeterminant=0,this._worldMatrixDeterminantIsDirty=!0,this._animationPropertiesOverride=null,this._isNode=!0,this.onDisposeObservable=new S,this._onDisposeObserver=null,this._behaviors=new Array,this.name=e,this.id=e,this._scene=t||z.LastCreatedScene,this.uniqueId=this._scene.getUniqueId(),this._initCache(),n&&this._addToSceneRootNodes()}getScene(){return this._scene}getEngine(){return this._scene.getEngine()}addBehavior(e,t=!1){return this._behaviors.indexOf(e)!==-1?this:(e.init(),this._scene.isLoading&&!t?this._scene.onDataLoadedObservable.addOnce(()=>{e.attach(this)}):e.attach(this),this._behaviors.push(e),this)}removeBehavior(e){let t=this._behaviors.indexOf(e);return t===-1?this:(this._behaviors[t].detach(),this._behaviors.splice(t,1),this)}get behaviors(){return this._behaviors}getBehaviorByName(e){for(let t of this._behaviors)if(t.name===e)return t;return null}getWorldMatrix(){return this._currentRenderId!==this._scene.getRenderId()&&this.computeWorldMatrix(),this._worldMatrix}_getWorldMatrixDeterminant(){return this._worldMatrixDeterminantIsDirty&&(this._worldMatrixDeterminantIsDirty=!1,this._worldMatrixDeterminant=this._worldMatrix.determinant()),this._worldMatrixDeterminant}get worldMatrixFromCache(){return this._worldMatrix}_initCache(){this._cache={}}updateCache(e){!e&&this.isSynchronized()||this._updateCache()}_getActionManagerForTrigger(e,t=!0){return this.parent?this.parent._getActionManagerForTrigger(e,!1):null}_updateCache(e){}_isSynchronized(){return!0}_markSyncedWithParent(){this._parentNode&&(this._parentUpdateId=this._parentNode._childUpdateId)}isSynchronizedWithParent(){return this._parentNode?this._parentNode._isDirty||this._parentUpdateId!==this._parentNode._childUpdateId?!1:this._parentNode.isSynchronized():!0}isSynchronized(){return this._parentNode&&!this.isSynchronizedWithParent()?!1:this._isSynchronized()}isReady(e=!1){return this._nodeDataStorage._isReady}markAsDirty(e){return this._currentRenderId=Number.MAX_VALUE,this._isDirty=!0,this}isEnabled(e=!0){return e===!1?this._nodeDataStorage._isEnabled:this._nodeDataStorage._isEnabled?this._nodeDataStorage._isParentEnabled:!1}_syncParentEnabledState(){if(this._nodeDataStorage._isParentEnabled=this._parentNode?this._parentNode.isEnabled():!0,this._children)for(let e of this._children)e._syncParentEnabledState()}setEnabled(e){this._nodeDataStorage._isEnabled!==e&&(this._nodeDataStorage._isEnabled=e,this._syncParentEnabledState(),this._nodeDataStorage._onEnabledStateChangedObservable.notifyObservers(e))}isDescendantOf(e){return this.parent?this.parent===e?!0:this.parent.isDescendantOf(e):!1}_getDescendants(e,t=!1,n){if(this._children)for(let a=0;a<this._children.length;a++){let i=this._children[a];(!n||n(i))&&e.push(i),t||i._getDescendants(e,!1,n)}}getDescendants(e,t){let n=[];return this._getDescendants(n,e,t),n}getChildMeshes(e,t){let n=[];return this._getDescendants(n,e,a=>(!t||t(a))&&a.cullingStrategy!==void 0),n}getChildren(e,t=!0){return this.getDescendants(t,e)}_setReady(e){if(e!==this._nodeDataStorage._isReady){if(!e){this._nodeDataStorage._isReady=!1;return}this.onReady&&this.onReady(this),this._nodeDataStorage._isReady=!0}}getAnimationByName(e){for(let t=0;t<this.animations.length;t++){let n=this.animations[t];if(n.name===e)return n}return null}createAnimationRange(e,t,n){if(!this._ranges[e]){this._ranges[e]=s._AnimationRangeFactory(e,t,n);for(let a=0,i=this.animations.length;a<i;a++)this.animations[a]&&this.animations[a].createRange(e,t,n)}}deleteAnimationRange(e,t=!0){for(let n=0,a=this.animations.length;n<a;n++)this.animations[n]&&this.animations[n].deleteRange(e,t);this._ranges[e]=null}getAnimationRange(e){return this._ranges[e]||null}clone(e,t,n){let a=C.Clone(()=>new s(e,this.getScene()),this);if(t&&(a.parent=t),!n){let i=this.getDescendants(!0);for(let o=0;o<i.length;o++){let r=i[o];r.clone(e+"."+r.name,a)}}return a}getAnimationRanges(){let e=[],t;for(t in this._ranges)e.push(this._ranges[t]);return e}beginAnimation(e,t,n,a){let i=this.getAnimationRange(e);return i?this._scene.beginAnimation(this,i.from,i.to,t,n,a):null}serializeAnimationRanges(){let e=[];for(let t in this._ranges){let n=this._ranges[t];if(!n)continue;let a={};a.name=t,a.from=n.from,a.to=n.to,e.push(a)}return e}computeWorldMatrix(e){return this._worldMatrix||(this._worldMatrix=m.Identity()),this._worldMatrix}dispose(e,t=!1){if(this._nodeDataStorage._isDisposed=!0,!e){let n=this.getDescendants(!0);for(let a of n)a.dispose(e,t)}this.parent?this.parent=null:this._removeFromSceneRootNodes(),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onEnabledStateChangedObservable.clear(),this.onClonedObservable.clear();for(let n of this._behaviors)n.detach();this._behaviors.length=0,this.metadata=null}static ParseAnimationRanges(e,t,n){if(t.ranges)for(let a=0;a<t.ranges.length;a++){let i=t.ranges[a];e.createAnimationRange(i.name,i.from,i.to)}}getHierarchyBoundingVectors(e=!0,t=null){this.getScene().incrementRenderId(),this.computeWorldMatrix(!0);let n,a,i=this;if(i.getBoundingInfo&&i.subMeshes){let o=i.getBoundingInfo();n=o.boundingBox.minimumWorld.clone(),a=o.boundingBox.maximumWorld.clone()}else n=new T(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a=new T(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);if(e){let o=this.getDescendants(!1);for(let r of o){let l=r;if(l.computeWorldMatrix(!0),t&&!t(l)||!l.getBoundingInfo||l.getTotalVertices()===0)continue;let u=l.getBoundingInfo().boundingBox,h=u.minimumWorld,d=u.maximumWorld;T.CheckExtends(h,n,a),T.CheckExtends(d,n,a)}}return{min:n,max:a}}};N._AnimationRangeFactory=(s,e,t)=>{throw K("AnimationRange")};N._NodeConstructors={};v([b()],N.prototype,"name",void 0);v([b()],N.prototype,"id",void 0);v([b()],N.prototype,"uniqueId",void 0);v([b()],N.prototype,"state",void 0);v([b()],N.prototype,"metadata",void 0);var W=Object.freeze(new p(0,0,0,0)),Q=Object.freeze(T.Zero()),q=Object.freeze(D.Zero()),j=Object.freeze(k.Zero()),X=Object.freeze(E.Black()),H=Object.freeze(new M(0,0,0,0)),I={key:0,repeatCount:0,loopMode:2},_=class s{static _PrepareAnimation(e,t,n,a,i,o,r,l){let c;if(!isNaN(parseFloat(i))&&isFinite(i)?c=s.ANIMATIONTYPE_FLOAT:i instanceof p?c=s.ANIMATIONTYPE_QUATERNION:i instanceof T?c=s.ANIMATIONTYPE_VECTOR3:i instanceof D?c=s.ANIMATIONTYPE_VECTOR2:i instanceof E?c=s.ANIMATIONTYPE_COLOR3:i instanceof M?c=s.ANIMATIONTYPE_COLOR4:i instanceof k&&(c=s.ANIMATIONTYPE_SIZE),c==null)return null;let u=new s(e,t,n,c,r),h=[{frame:0,value:i},{frame:a,value:o}];return u.setKeys(h),l!==void 0&&u.setEasingFunction(l),u}static CreateAnimation(e,t,n,a){let i=new s(e+"Animation",e,n,t,s.ANIMATIONLOOPMODE_CONSTANT);return i.setEasingFunction(a),i}static CreateAndStartAnimation(e,t,n,a,i,o,r,l,c,u,h){let d=s._PrepareAnimation(e,n,a,i,o,r,l,c);return!d||(t.getScene&&(h=t.getScene()),!h)?null:h.beginDirectAnimation(t,[d],0,i,d.loopMode!==s.ANIMATIONLOOPMODE_CONSTANT,1,u)}static CreateAndStartHierarchyAnimation(e,t,n,a,i,o,r,l,c,u,h){let d=s._PrepareAnimation(e,a,i,o,r,l,c,u);return d?t.getScene().beginDirectHierarchyAnimation(t,n,[d],0,o,d.loopMode===1,1,h):null}static CreateMergeAndStartAnimation(e,t,n,a,i,o,r,l,c,u){let h=s._PrepareAnimation(e,n,a,i,o,r,l,c);return h?(t.animations.push(h),t.getScene().beginAnimation(t,0,i,h.loopMode===1,1,u)):null}static MakeAnimationAdditive(e,t,n,a=!1,i){let o;typeof t=="object"?o=t:o={referenceFrame:t??0,range:n,cloneOriginalAnimation:a,clonedAnimationName:i};let r=e;if(o.cloneOriginalAnimation&&(r=e.clone(),r.name=o.clonedAnimationName||r.name),!r._keys.length)return r;let l=o.referenceFrame&&o.referenceFrame>=0?o.referenceFrame:0,c=0,u=r._keys[0],h=r._keys.length-1,d=r._keys[h],f={referenceValue:u.value,referencePosition:y.Vector3[0],referenceQuaternion:y.Quaternion[0],referenceScaling:y.Vector3[1],keyPosition:y.Vector3[2],keyQuaternion:y.Quaternion[1],keyScaling:y.Vector3[3]},O=u.frame,P=d.frame;if(o.range){let g=r.getRange(o.range);g&&(O=g.from,P=g.to)}else O=o.fromFrame??O,P=o.toFrame??P;if(O!==u.frame&&(c=r.createKeyForFrame(O)),P!==d.frame&&(h=r.createKeyForFrame(P)),r._keys.length===1){let g=r._getKeyValue(r._keys[0]);f.referenceValue=g.clone?g.clone():g}else if(l<=u.frame){let g=r._getKeyValue(u.value);f.referenceValue=g.clone?g.clone():g}else if(l>=d.frame){let g=r._getKeyValue(d.value);f.referenceValue=g.clone?g.clone():g}else{I.key=0;let g=r._interpolate(l,I);f.referenceValue=g.clone?g.clone():g}r.dataType===s.ANIMATIONTYPE_QUATERNION?f.referenceValue.normalize().conjugateInPlace():r.dataType===s.ANIMATIONTYPE_MATRIX&&(f.referenceValue.decompose(f.referenceScaling,f.referenceQuaternion,f.referencePosition),f.referenceQuaternion.normalize().conjugateInPlace());let F=Number.MAX_VALUE,R=o.clipKeys?[]:null;for(let g=c;g<=h;g++){let A=r._keys[g];if((R||o.cloneOriginalAnimation)&&(A={frame:A.frame,value:A.value.clone?A.value.clone():A.value,inTangent:A.inTangent,outTangent:A.outTangent,interpolation:A.interpolation,lockedTangent:A.lockedTangent},R&&(F===Number.MAX_VALUE&&(F=A.frame),A.frame-=F,R.push(A))),!(g&&r.dataType!==s.ANIMATIONTYPE_FLOAT&&A.value===u.value))switch(r.dataType){case s.ANIMATIONTYPE_MATRIX:A.value.decompose(f.keyScaling,f.keyQuaternion,f.keyPosition),f.keyPosition.subtractInPlace(f.referencePosition),f.keyScaling.divideInPlace(f.referenceScaling),f.referenceQuaternion.multiplyToRef(f.keyQuaternion,f.keyQuaternion),m.ComposeToRef(f.keyScaling,f.keyQuaternion,f.keyPosition,A.value);break;case s.ANIMATIONTYPE_QUATERNION:f.referenceValue.multiplyToRef(A.value,A.value);break;case s.ANIMATIONTYPE_VECTOR2:case s.ANIMATIONTYPE_VECTOR3:case s.ANIMATIONTYPE_COLOR3:case s.ANIMATIONTYPE_COLOR4:A.value.subtractToRef(f.referenceValue,A.value);break;case s.ANIMATIONTYPE_SIZE:A.value.width-=f.referenceValue.width,A.value.height-=f.referenceValue.height;break;default:A.value-=f.referenceValue}}return R&&r.setKeys(R,!0),r}static TransitionTo(e,t,n,a,i,o,r,l=null){if(r<=0)return n[e]=t,l&&l(),null;let c=i*(r/1e3);o.setKeys([{frame:0,value:n[e].clone?n[e].clone():n[e]},{frame:c,value:t}]),n.animations||(n.animations=[]),n.animations.push(o);let u=a.beginAnimation(n,0,c,!1);return u.onAnimationEnd=l,u}get runtimeAnimations(){return this._runtimeAnimations}get hasRunningRuntimeAnimations(){for(let e of this._runtimeAnimations)if(!e.isStopped())return!0;return!1}constructor(e,t,n,a,i,o){this.name=e,this.targetProperty=t,this.framePerSecond=n,this.dataType=a,this.loopMode=i,this.enableBlending=o,this._easingFunction=null,this._runtimeAnimations=new Array,this._events=new Array,this.blendingSpeed=.01,this._ranges={},this._coreAnimation=null,this.targetPropertyPath=t.split("."),this.dataType=a,this.loopMode=i===void 0?s.ANIMATIONLOOPMODE_CYCLE:i,this.uniqueId=s._UniqueIdGenerator++}toString(e){let t="Name: "+this.name+", property: "+this.targetProperty;if(t+=", datatype: "+["Float","Vector3","Quaternion","Matrix","Color3","Vector2"][this.dataType],t+=", nKeys: "+(this._keys?this._keys.length:"none"),t+=", nRanges: "+(this._ranges?Object.keys(this._ranges).length:"none"),e){t+=", Ranges: {";let n=!0;for(let a in this._ranges)n&&(t+=", ",n=!1),t+=a;t+="}"}return t}addEvent(e){this._events.push(e),this._events.sort((t,n)=>t.frame-n.frame)}removeEvents(e){for(let t=0;t<this._events.length;t++)this._events[t].frame===e&&(this._events.splice(t,1),t--)}getEvents(){return this._events}createRange(e,t,n){this._ranges[e]||(this._ranges[e]=new L(e,t,n))}deleteRange(e,t=!0){let n=this._ranges[e];if(n){if(t){let a=n.from,i=n.to;for(let o=this._keys.length-1;o>=0;o--)this._keys[o].frame>=a&&this._keys[o].frame<=i&&this._keys.splice(o,1)}this._ranges[e]=null}}getRange(e){return this._ranges[e]}getKeys(){return this._keys}getHighestFrame(){let e=0;for(let t=0,n=this._keys.length;t<n;t++)e<this._keys[t].frame&&(e=this._keys[t].frame);return e}getEasingFunction(){return this._easingFunction}setEasingFunction(e){this._easingFunction=e}floatInterpolateFunction(e,t,n){return U(e,t,n)}floatInterpolateFunctionWithTangents(e,t,n,a,i){return B(e,t,n,a,i)}quaternionInterpolateFunction(e,t,n){return p.Slerp(e,t,n)}quaternionInterpolateFunctionWithTangents(e,t,n,a,i){return p.Hermite(e,t,n,a,i).normalize()}vector3InterpolateFunction(e,t,n){return T.Lerp(e,t,n)}vector3InterpolateFunctionWithTangents(e,t,n,a,i){return T.Hermite(e,t,n,a,i)}vector2InterpolateFunction(e,t,n){return D.Lerp(e,t,n)}vector2InterpolateFunctionWithTangents(e,t,n,a,i){return D.Hermite(e,t,n,a,i)}sizeInterpolateFunction(e,t,n){return k.Lerp(e,t,n)}color3InterpolateFunction(e,t,n){return E.Lerp(e,t,n)}color3InterpolateFunctionWithTangents(e,t,n,a,i){return E.Hermite(e,t,n,a,i)}color4InterpolateFunction(e,t,n){return M.Lerp(e,t,n)}color4InterpolateFunctionWithTangents(e,t,n,a,i){return M.Hermite(e,t,n,a,i)}_getKeyValue(e){return typeof e=="function"?e():e}evaluate(e){return I.key=0,this._interpolate(e,I)}_interpolate(e,t,n=!1){if(t.loopMode===s.ANIMATIONLOOPMODE_CONSTANT&&t.repeatCount>0)return t.highLimitValue.clone?t.highLimitValue.clone():t.highLimitValue;let a=this._keys,i;if(this._coreAnimation)i=this._coreAnimation._key;else{let O=a.length;for(i=t.key;i>=0&&e<a[i].frame;)--i;for(;i+1<=O-1&&e>=a[i+1].frame;)++i;if(t.key=i,i<0)return n?void 0:this._getKeyValue(a[0].value);if(i+1>O-1)return n?void 0:this._getKeyValue(a[O-1].value);this._key=i}let o=a[i],r=a[i+1];if(n&&(e===o.frame||e===r.frame))return;let l=this._getKeyValue(o.value),c=this._getKeyValue(r.value);if(o.interpolation===1)return r.frame>e?l:c;let u=o.outTangent!==void 0&&r.inTangent!==void 0,h=r.frame-o.frame,d=(e-o.frame)/h,f=o.easingFunction||this.getEasingFunction();switch(f&&(d=f.ease(d)),this.dataType){case s.ANIMATIONTYPE_FLOAT:{let O=u?this.floatInterpolateFunctionWithTangents(l,o.outTangent*h,c,r.inTangent*h,d):this.floatInterpolateFunction(l,c,d);switch(t.loopMode){case s.ANIMATIONLOOPMODE_CYCLE:case s.ANIMATIONLOOPMODE_CONSTANT:case s.ANIMATIONLOOPMODE_YOYO:return O;case s.ANIMATIONLOOPMODE_RELATIVE:case s.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return(t.offsetValue??0)*t.repeatCount+O}break}case s.ANIMATIONTYPE_QUATERNION:{let O=u?this.quaternionInterpolateFunctionWithTangents(l,o.outTangent.scale(h),c,r.inTangent.scale(h),d):this.quaternionInterpolateFunction(l,c,d);switch(t.loopMode){case s.ANIMATIONLOOPMODE_CYCLE:case s.ANIMATIONLOOPMODE_CONSTANT:case s.ANIMATIONLOOPMODE_YOYO:return O;case s.ANIMATIONLOOPMODE_RELATIVE:case s.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return O.addInPlace((t.offsetValue||W).scale(t.repeatCount))}return O}case s.ANIMATIONTYPE_VECTOR3:{let O=u?this.vector3InterpolateFunctionWithTangents(l,o.outTangent.scale(h),c,r.inTangent.scale(h),d):this.vector3InterpolateFunction(l,c,d);switch(t.loopMode){case s.ANIMATIONLOOPMODE_CYCLE:case s.ANIMATIONLOOPMODE_CONSTANT:case s.ANIMATIONLOOPMODE_YOYO:return O;case s.ANIMATIONLOOPMODE_RELATIVE:case s.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return O.add((t.offsetValue||Q).scale(t.repeatCount))}break}case s.ANIMATIONTYPE_VECTOR2:{let O=u?this.vector2InterpolateFunctionWithTangents(l,o.outTangent.scale(h),c,r.inTangent.scale(h),d):this.vector2InterpolateFunction(l,c,d);switch(t.loopMode){case s.ANIMATIONLOOPMODE_CYCLE:case s.ANIMATIONLOOPMODE_CONSTANT:case s.ANIMATIONLOOPMODE_YOYO:return O;case s.ANIMATIONLOOPMODE_RELATIVE:case s.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return O.add((t.offsetValue||q).scale(t.repeatCount))}break}case s.ANIMATIONTYPE_SIZE:{switch(t.loopMode){case s.ANIMATIONLOOPMODE_CYCLE:case s.ANIMATIONLOOPMODE_CONSTANT:case s.ANIMATIONLOOPMODE_YOYO:return this.sizeInterpolateFunction(l,c,d);case s.ANIMATIONLOOPMODE_RELATIVE:case s.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return this.sizeInterpolateFunction(l,c,d).add((t.offsetValue||j).scale(t.repeatCount))}break}case s.ANIMATIONTYPE_COLOR3:{let O=u?this.color3InterpolateFunctionWithTangents(l,o.outTangent.scale(h),c,r.inTangent.scale(h),d):this.color3InterpolateFunction(l,c,d);switch(t.loopMode){case s.ANIMATIONLOOPMODE_CYCLE:case s.ANIMATIONLOOPMODE_CONSTANT:case s.ANIMATIONLOOPMODE_YOYO:return O;case s.ANIMATIONLOOPMODE_RELATIVE:case s.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return O.add((t.offsetValue||X).scale(t.repeatCount))}break}case s.ANIMATIONTYPE_COLOR4:{let O=u?this.color4InterpolateFunctionWithTangents(l,o.outTangent.scale(h),c,r.inTangent.scale(h),d):this.color4InterpolateFunction(l,c,d);switch(t.loopMode){case s.ANIMATIONLOOPMODE_CYCLE:case s.ANIMATIONLOOPMODE_CONSTANT:case s.ANIMATIONLOOPMODE_YOYO:return O;case s.ANIMATIONLOOPMODE_RELATIVE:case s.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return O.add((t.offsetValue||H).scale(t.repeatCount))}break}case s.ANIMATIONTYPE_MATRIX:{switch(t.loopMode){case s.ANIMATIONLOOPMODE_CYCLE:case s.ANIMATIONLOOPMODE_CONSTANT:case s.ANIMATIONLOOPMODE_YOYO:return s.AllowMatricesInterpolation?this.matrixInterpolateFunction(l,c,d,t.workValue):l;case s.ANIMATIONLOOPMODE_RELATIVE:case s.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return l}break}}return 0}matrixInterpolateFunction(e,t,n,a){return s.AllowMatrixDecomposeForInterpolation?a?(m.DecomposeLerpToRef(e,t,n,a),a):m.DecomposeLerp(e,t,n):a?(m.LerpToRef(e,t,n,a),a):m.Lerp(e,t,n)}clone(){let e=new s(this.name,this.targetPropertyPath.join("."),this.framePerSecond,this.dataType,this.loopMode);if(e.enableBlending=this.enableBlending,e.blendingSpeed=this.blendingSpeed,this._keys&&e.setKeys(this._keys),this._ranges){e._ranges={};for(let t in this._ranges){let n=this._ranges[t];n&&(e._ranges[t]=n.clone())}}return e}setKeys(e,t=!1){this._keys=t?e:e.slice(0)}createKeyForFrame(e){I.key=0;let t=this._interpolate(e,I,!0);if(!t)return this._keys[I.key].frame===e?I.key:I.key+1;let n={frame:e,value:t.clone?t.clone():t};return this._keys.splice(I.key+1,0,n),I.key+1}serialize(){let e={};e.name=this.name,e.property=this.targetProperty,e.framePerSecond=this.framePerSecond,e.dataType=this.dataType,e.loopBehavior=this.loopMode,e.enableBlending=this.enableBlending,e.blendingSpeed=this.blendingSpeed;let t=this.dataType;e.keys=[];let n=this.getKeys();for(let a=0;a<n.length;a++){let i=n[a],o={};switch(o.frame=i.frame,t){case s.ANIMATIONTYPE_FLOAT:o.values=[i.value],i.inTangent!==void 0&&o.values.push(i.inTangent),i.outTangent!==void 0&&(i.inTangent===void 0&&o.values.push(void 0),o.values.push(i.outTangent)),i.interpolation!==void 0&&(i.inTangent===void 0&&o.values.push(void 0),i.outTangent===void 0&&o.values.push(void 0),o.values.push(i.interpolation));break;case s.ANIMATIONTYPE_QUATERNION:case s.ANIMATIONTYPE_MATRIX:case s.ANIMATIONTYPE_VECTOR3:case s.ANIMATIONTYPE_COLOR3:case s.ANIMATIONTYPE_COLOR4:o.values=i.value.asArray(),i.inTangent!=null&&o.values.push(i.inTangent.asArray()),i.outTangent!=null&&(i.inTangent===void 0&&o.values.push(void 0),o.values.push(i.outTangent.asArray())),i.interpolation!==void 0&&(i.inTangent===void 0&&o.values.push(void 0),i.outTangent===void 0&&o.values.push(void 0),o.values.push(i.interpolation));break}e.keys.push(o)}e.ranges=[];for(let a in this._ranges){let i=this._ranges[a];if(!i)continue;let o={};o.name=a,o.from=i.from,o.to=i.to,e.ranges.push(o)}return e}static _UniversalLerp(e,t,n){let a=e.constructor;return a.Lerp?a.Lerp(e,t,n):a.Slerp?a.Slerp(e,t,n):e.toFixed?e*(1-n)+n*t:t}static Parse(e){let t=new s(e.name,e.property,e.framePerSecond,e.dataType,e.loopBehavior),n=e.dataType,a=[],i,o;for(e.enableBlending&&(t.enableBlending=e.enableBlending),e.blendingSpeed&&(t.blendingSpeed=e.blendingSpeed),o=0;o<e.keys.length;o++){let r=e.keys[o],l,c,u;switch(n){case s.ANIMATIONTYPE_FLOAT:i=r.values[0],r.values.length>=2&&(l=r.values[1]),r.values.length>=3&&(c=r.values[2]),r.values.length>=4&&(u=r.values[3]);break;case s.ANIMATIONTYPE_QUATERNION:if(i=p.FromArray(r.values),r.values.length>=8){let d=p.FromArray(r.values.slice(4,8));d.equals(p.Zero())||(l=d)}if(r.values.length>=12){let d=p.FromArray(r.values.slice(8,12));d.equals(p.Zero())||(c=d)}r.values.length>=13&&(u=r.values[12]);break;case s.ANIMATIONTYPE_MATRIX:i=m.FromArray(r.values),r.values.length>=17&&(u=r.values[16]);break;case s.ANIMATIONTYPE_COLOR3:i=E.FromArray(r.values),r.values[3]&&(l=E.FromArray(r.values[3])),r.values[4]&&(c=E.FromArray(r.values[4])),r.values[5]&&(u=r.values[5]);break;case s.ANIMATIONTYPE_COLOR4:i=M.FromArray(r.values),r.values[4]&&(l=M.FromArray(r.values[4])),r.values[5]&&(c=M.FromArray(r.values[5])),r.values[6]&&(u=M.FromArray(r.values[6]));break;case s.ANIMATIONTYPE_VECTOR3:default:i=T.FromArray(r.values),r.values[3]&&(l=T.FromArray(r.values[3])),r.values[4]&&(c=T.FromArray(r.values[4])),r.values[5]&&(u=r.values[5]);break}let h={};h.frame=r.frame,h.value=i,l!=null&&(h.inTangent=l),c!=null&&(h.outTangent=c),u!=null&&(h.interpolation=u),a.push(h)}if(t.setKeys(a),e.ranges)for(o=0;o<e.ranges.length;o++)i=e.ranges[o],t.createRange(i.name,i.from,i.to);return t}static AppendSerializedAnimations(e,t){C.AppendSerializedAnimations(e,t)}static ParseFromFileAsync(e,t){return V(this,null,function*(){return yield new Promise((n,a)=>{let i=new x;i.addEventListener("readystatechange",()=>{if(i.readyState==4)if(i.status==200){let o=JSON.parse(i.responseText);if(o.animations&&(o=o.animations),o.length){let r=[];for(let l of o)r.push(this.Parse(l));n(r)}else{let r=this.Parse(o);e&&(r.name=e),n(r)}}else a("Unable to load the animation")}),i.open("GET",t),i.send()})})}static ParseFromSnippetAsync(e){return V(this,null,function*(){return yield new Promise((t,n)=>{let a=new x;a.addEventListener("readystatechange",()=>{if(a.readyState==4)if(a.status==200){let i=JSON.parse(JSON.parse(a.responseText).jsonPayload);if(i.animations){let o=JSON.parse(i.animations),r=[];for(let l of o.animations){let c=this.Parse(l);c.snippetId=e,r.push(c)}t(r)}else{let o=JSON.parse(i.animation),r=this.Parse(o);r.snippetId=e,t(r)}}else n("Unable to load the snippet "+e)}),a.open("GET",this.SnippetUrl+"/"+e.replace(/#/g,"/")),a.send()})})}};_._UniqueIdGenerator=0;_.AllowMatricesInterpolation=!1;_.AllowMatrixDecomposeForInterpolation=!0;_.SnippetUrl="https://snippet.babylonjs.com";_.ANIMATIONTYPE_FLOAT=0;_.ANIMATIONTYPE_VECTOR3=1;_.ANIMATIONTYPE_QUATERNION=2;_.ANIMATIONTYPE_MATRIX=3;_.ANIMATIONTYPE_COLOR3=4;_.ANIMATIONTYPE_COLOR4=7;_.ANIMATIONTYPE_VECTOR2=5;_.ANIMATIONTYPE_SIZE=6;_.ANIMATIONLOOPMODE_RELATIVE=0;_.ANIMATIONLOOPMODE_CYCLE=1;_.ANIMATIONLOOPMODE_CONSTANT=2;_.ANIMATIONLOOPMODE_YOYO=4;_.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT=5;_.CreateFromSnippetAsync=_.ParseFromSnippetAsync;w("BABYLON.Animation",_);N._AnimationRangeFactory=(s,e,t)=>new L(s,e,t);export{L as a,N as b,W as c,Q as d,q as e,j as f,X as g,H as h,_ as i};
