import{b as d}from"./chunk-6LMVZKMZ.js";import{a as P,b as A}from"./chunk-NXKIOJ4R.js";import{g as m,h as y,j as w,k as T}from"./chunk-4QVQQIPQ.js";import{a as g}from"./chunk-A3WFPZFR.js";var p=class i{static Eval(e,r){return e.match(/\([^()]*\)/g)?e=e.replace(/\([^()]*\)/g,t=>(t=t.slice(1,t.length-1),i._HandleParenthesisContent(t,r))):e=i._HandleParenthesisContent(e,r),e==="true"?!0:e==="false"?!1:i.Eval(e,r)}static _HandleParenthesisContent(e,r){r=r||(c=>c==="true");let t,n=e.split("||");for(let c in n)if(Object.prototype.hasOwnProperty.call(n,c)){let o=i._SimplifyNegation(n[c].trim()),a=o.split("&&");if(a.length>1)for(let f=0;f<a.length;++f){let s=i._SimplifyNegation(a[f].trim());if(s!=="true"&&s!=="false"?s[0]==="!"?t=!r(s.substring(1)):t=r(s):t=s==="true",!t){o="false";break}}if(t||o==="true"){t=!0;break}o!=="true"&&o!=="false"?o[0]==="!"?t=!r(o.substring(1)):t=r(o):t=o==="true"}return t?"true":"false"}static _SimplifyNegation(e){return e=e.replace(/^[\s!]+/,r=>(r=r.replace(/[\s]/g,()=>""),r.length%2?"!":"")),e=e.trim(),e==="!true"?e="false":e==="!false"&&(e="true"),e}};var u=class i{static EnableFor(e){e._tags=e._tags||{},e.hasTags=()=>i.HasTags(e),e.addTags=r=>i.AddTagsTo(e,r),e.removeTags=r=>i.RemoveTagsFrom(e,r),e.matchesTagsQuery=r=>i.MatchesQuery(e,r)}static DisableFor(e){delete e._tags,delete e.hasTags,delete e.addTags,delete e.removeTags,delete e.matchesTagsQuery}static HasTags(e){if(!e._tags)return!1;let r=e._tags;for(let t in r)if(Object.prototype.hasOwnProperty.call(r,t))return!0;return!1}static GetTags(e,r=!0){if(!e._tags)return null;if(r){let t=[];for(let n in e._tags)Object.prototype.hasOwnProperty.call(e._tags,n)&&e._tags[n]===!0&&t.push(n);return t.join(" ")}else return e._tags}static AddTagsTo(e,r){if(!r||typeof r!="string")return;let t=r.split(" ");for(let n of t)i._AddTagTo(e,n)}static _AddTagTo(e,r){r=r.trim(),!(r===""||r==="true"||r==="false")&&(r.match(/[\s]/)||r.match(/^([!]|([|]|[&]){2})/)||(i.EnableFor(e),e._tags[r]=!0))}static RemoveTagsFrom(e,r){if(!i.HasTags(e))return;let t=r.split(" ");for(let n in t)i._RemoveTagFrom(e,t[n])}static _RemoveTagFrom(e,r){delete e._tags[r]}static MatchesQuery(e,r){return r===void 0?!0:r===""?i.HasTags(e):p.Eval(r,t=>i.HasTags(e)&&e._tags[t])}};var k=function(i,e,r,t={}){let n=i();u&&u.HasTags(e)&&u.AddTagsTo(n,u.GetTags(e,!0));let c=d(n),o={};for(let a in c){let f=c[a],s=e[a],l=f.type;if(s!=null&&(a!=="uniqueId"||I.AllowLoadingUniqueId))switch(l){case 0:case 6:case 9:case 11:n[a]=s;break;case 1:t.cloneTexturesOnlyOnce&&o[s.uniqueId]?n[a]=o[s.uniqueId]:(n[a]=r||s.isRenderTarget?s:s.clone(),o[s.uniqueId]=n[a]);break;case 2:case 3:case 4:case 5:case 7:case 8:case 10:case 12:n[a]=r?s:s.clone();break}}return n},I=(()=>{class i{static AppendSerializedAnimations(r,t){if(r.animations){t.animations=[];for(let n=0;n<r.animations.length;n++){let c=r.animations[n];t.animations.push(c.serialize())}}}static Serialize(r,t){t||(t={}),u&&(t.tags=u.GetTags(r));let n=d(r);for(let c in n){let o=n[c],a=o.sourceName||c,f=o.type,s=r[c];if(s!=null&&(c!=="uniqueId"||i.AllowLoadingUniqueId))switch(f){case 0:t[a]=s;break;case 1:t[a]=s.serialize();break;case 2:t[a]=s.asArray();break;case 3:t[a]=s.serialize();break;case 4:t[a]=s.asArray();break;case 5:t[a]=s.asArray();break;case 6:t[a]=s.id;break;case 7:t[a]=s.serialize();break;case 8:t[a]=s.asArray();break;case 9:t[a]=s.serialize();break;case 10:t[a]=s.asArray();break;case 11:t[a]=s.id;break;case 12:t[a]=s.asArray();break}}return t}static ParseProperties(r,t,n,c){c||(c="");let o=d(t);for(let a in o){let f=o[a],s=r[f.sourceName||a],l=f.type;if(s!=null&&(a!=="uniqueId"||i.AllowLoadingUniqueId)){let h=t;switch(l){case 0:h[a]=s;break;case 1:n&&(h[a]=i._TextureParser(s,n,c));break;case 2:h[a]=P.FromArray(s);break;case 3:h[a]=i._FresnelParametersParser(s);break;case 4:h[a]=m.FromArray(s);break;case 5:h[a]=y.FromArray(s);break;case 6:n&&(h[a]=n.getLastMeshById(s));break;case 7:h[a]=i._ColorCurvesParser(s);break;case 8:h[a]=A.FromArray(s);break;case 9:h[a]=i._ImageProcessingConfigurationParser(s);break;case 10:h[a]=w.FromArray(s);break;case 11:n&&(h[a]=n.getCameraById(s));break;case 12:h[a]=T.FromArray(s);break}}}}static Parse(r,t,n,c=null){let o=r();return u&&u.AddTagsTo(o,t.tags),i.ParseProperties(t,o,n,c),o}static Clone(r,t,n={}){return k(r,t,!1,n)}static Instanciate(r,t){return k(r,t,!0)}}return i.AllowLoadingUniqueId=!1,i._ImageProcessingConfigurationParser=e=>{throw g("ImageProcessingConfiguration")},i._FresnelParametersParser=e=>{throw g("FresnelParameters")},i._ColorCurvesParser=e=>{throw g("ColorCurves")},i._TextureParser=(e,r,t)=>{throw g("Texture")},i})();var F=class i{constructor(e,r){this.width=e,this.height=r}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let e=this.width|0;return e=e*397^(this.height|0),e}copyFrom(e){this.width=e.width,this.height=e.height}copyFromFloats(e,r){return this.width=e,this.height=r,this}set(e,r){return this.copyFromFloats(e,r)}multiplyByFloats(e,r){return new i(this.width*e,this.height*r)}clone(){return new i(this.width,this.height)}equals(e){return e?this.width===e.width&&this.height===e.height:!1}get surface(){return this.width*this.height}static Zero(){return new i(0,0)}add(e){return new i(this.width+e.width,this.height+e.height)}subtract(e){return new i(this.width-e.width,this.height-e.height)}scale(e){return new i(this.width*e,this.height*e)}static Lerp(e,r,t){let n=e.width+(r.width-e.width)*t,c=e.height+(r.height-e.height)*t;return new i(n,c)}};export{u as a,I as b,F as c};
