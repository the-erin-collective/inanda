import{a as n}from"./chunk-PE7E5XW6.js";import{a,b as _,c as h,d as p}from"./chunk-ZD5BYDOU.js";import{j as r}from"./chunk-RLBU4MYZ.js";var u=class extends n{constructor(e,t){super(e,t),this._outBus=null,this._onOutBusDisposed=()=>{this.outBus=this.engine.defaultMainBus}}get outBus(){return this._outBus}set outBus(e){if(this._outBus!==e){if(this._outBus&&(this._outBus.onDisposeObservable.removeCallback(this._onOutBusDisposed),!this._disconnect(this._outBus)))throw new Error("Disconnect failed");if(this._outBus=e,this._outBus&&(this._outBus.onDisposeObservable.add(this._onOutBusDisposed),!this._connect(this._outBus)))throw new Error("Connect failed")}}dispose(){super.dispose(),this._outBus=null}};var N=(()=>{class s extends u{constructor(t,o,i){super(t,o),this._spatial=null,this._spatialAutoUpdate=!0,this._spatialMinUpdateTime=0,this._stereo=null,typeof i.spatialAutoUpdate=="boolean"&&(this._spatialAutoUpdate=i.spatialAutoUpdate),typeof i.spatialMinUpdateTime=="number"&&(this._spatialMinUpdateTime=i.spatialMinUpdateTime),this._subGraph=new s._SubGraph(this)}_initAsync(t){return r(this,null,function*(){t.outBus?this.outBus=t.outBus:(yield this.engine.isReadyPromise,this.outBus=this.engine.defaultMainBus),yield this._subGraph.initAsync(t),a(t)&&this._initSpatialProperty(),this.engine._addNode(this)})}dispose(){super.dispose(),this._spatial=null,this._stereo=null,this.engine._removeNode(this)}get _inNode(){return this._subGraph._inNode}get _outNode(){return this._subGraph._outNode}get spatial(){return this._spatial?this._spatial:this._initSpatialProperty()}get stereo(){return this._stereo??(this._stereo=new _(this._subGraph))}getClassName(){return"_WebAudioBus"}_connect(t){return super._connect(t)?(t._inNode&&this._outNode?.connect(t._inNode),!0):!1}_disconnect(t){return super._disconnect(t)?(t._inNode&&this._outNode?.disconnect(t._inNode),!0):!1}_initSpatialProperty(){return this._spatial||(this._spatial=new p(this._subGraph,this._spatialAutoUpdate,this._spatialMinUpdateTime)),this._spatial}}return s._SubGraph=class extends h{get _downstreamNodes(){return this._owner._downstreamNodes??null}get _upstreamNodes(){return this._owner._upstreamNodes??null}},s})();export{N as a};
